# III. METHODOLOGY

The development of the proposed system, "Classmos," employs a modern serverless architecture integrating Large Language Models (LLMs) for dynamic content generation and algorithmic gamification for personalized learning. This section details the system architecture, application development, and the specific algorithms implemented to drive adaptive learning.

## A. System Architecture

The system utilizes a client-side rendering architecture supported by Backend-as-a-Service (BaaS) and AI-as-a-Service (AIaaS) components. The architecture is event-driven, ensuring real-time synchronization between the user interface and the underlying data layer.

1.  **Frontend Layer:** Built using React 19, serving as the primary interface for student and teacher interactions.
2.  **Service Layer:** Acts as the intermediary, handling authentication (Firebase Auth), data persistence (Firestore), and AI orchestration (Google Gemini API).
3.  **Intelligence Layer:** Utilizes the Gemini 2.5 Flash model for Just-In-Time (JIT) content generation, transforming unstructured documents into structured educational schema (JSON).

## B. Web Application Development

The application is constructed using **TypeScript**, ensuring strict type safety across the full stack. The User Interface (UI) is developed with **React**, leveraging a component-based structure for modularity. **Tailwind CSS** is employed for utility-first styling, enabling a responsive design that adapts to various device form factors. State management utilizes React Hooks (`useState`, `useEffect`, `useReducer`) to handle complex game states, such as exercise progression and heart regeneration timers.

## C. User and Authentication Module

Security and identity management are handled via **Firebase Authentication**. The system implements a Role-Based Access Control (RBAC) mechanism:

*   **Authentication Methods:** Supports email/password credentials and Google OAuth provider.
*   **Role Management:** Upon registration, users are assigned a role (`student` or `teacher`). This role is persisted in the NoSQL database and verified client-side to enforce view restrictions.
*   **Session Persistence:** Real-time listeners (`onAuthStateChanged`) maintain session state across page reloads, synchronizing local application state with the remote authentication provider.

## D. Database Services

Data persistence is managed using **Google Cloud Firestore**, a scalable NoSQL document database. The data model is designed to support high-read frequency for the gamified dashboard:

*   **Users Collection:** Stores profile metadata, gamification stats (XP, gems, hearts), and the Spaced Repetition System (SRS) items array.
*   **Courses Collection:** Stores course metadata and the hierarchical JSON structure (Units $\rightarrow$ Sections $\rightarrow$ Cheat Sheets) generated by the AI.
*   **Progress Sub-collection:** A nested collection within each user document tracking lesson completion status, allowing for granular query performance and security rule enforcement.

## E. Student Dashboard and Gamification

The student interface implements a node-based learning path visualization. Key engineered features include:

*   **Heart System:** A limiter mechanic where incorrect answers deplete "Hearts." A background timer service regenerates one heart every 5 minutes ($300,000$ ms) using timestamp diffing logic (`Date.now() - lastRefill`).
*   **Experience Points (XP):** Awarded based on lesson performance, feeding into a competitive leaderboard system.
*   **Streaks:** Tracks consecutive days of activity. Logic compares the current server timestamp with the `lastActiveDate` to determine streak increment or reset.

## F. Teacher Dashboard and AI Content Generation

The teacher module focuses on content creation and analytics. The content generation pipeline employs a Retrieval-Augmented Generation (RAG-Lite) approach:

1.  **Ingestion:** The system accepts unstructured data (PDF, Images) converted to Base64.
2.  **Schema Enforcement:** The Gemini API is invoked with a strict `responseSchema`, forcing the LLM to output a specific `CourseStructure` JSON object.
3.  **Analytics:** The dashboard aggregates student data to visualize class performance. A scatter plot visualizes the correlation between **Total Accuracy** and **Elo Rating**, allowing for the automatic clustering of students into categories such as "Top Performer" or "Needs Support."

## G. Algorithmic Implementation

The system integrates two core algorithms to personalize the learning experience:

### 1. Adaptive Elo Rating System
To dynamically track student skill proficiency relative to lesson difficulty, the system adapts the Elo rating system used in competitive games.

*   **Initialization:** Students begin with a baseline rating ($R_A$) of 800.
*   **Lesson Ratings:** Lessons are assigned static difficulty ratings ($R_B$): Easy (800), Medium (1200), and Hard (1600).
*   **Expectation Formula:** The expected score $E_A$ is calculated as:
    $$E_A = \frac{1}{1 + 10^{(R_B - R_A) / 400}}$$
*   **Rating Update:** The new rating $R'_A$ is derived using a K-factor of 32:
    $$R'_A = R_A + 32(S_{actual} - E_A)$$
    Where $S_{actual}$ is the normalized accuracy score (0 to 1). This ensures that proficiency ratings grow significantly only when students succeed in difficult tasks.

### 2. Spaced Repetition System (SRS)
To optimize long-term retention, the system implements a variation of the **SuperMemo-2 (SM-2)** algorithm.

*   **Variables:** Tracks `interval` (days), `easeFactor` (multiplier), and `streak` for specific concepts.
*   **Logic:**
    *   *Correct Response:* The review interval ($I$) increases exponentially: $I_n = I_{n-1} \times EF$. The `easeFactor` ($EF$) increments by 0.1 (capped at 5.0) to reflect mastery.
    *   *Incorrect Response:* The interval resets to 1 day, and the `easeFactor` is penalized by 0.2 (floored at 1.3).
*   **Integration:** During quiz generation, the system queries the SRS database for concepts where `nextReview < Date.now()`. These concepts are injected into the LLM prompt context ("PRIORITY CONCEPTS"), forcing the AI to generate questions specifically targeting decaying knowledge.